<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Alunos</title>
</head>
<body>
    <h1>Gerenciamento de Alunos</h1>
    
    <h2>Cadastro de Alunos</h2>
    <form id="formulario">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" required>
        
        <label for="idade">Idade:</label>
        <input type="number" id="idade" required>
        
        <label for="curso">Curso:</label>
        <select id="curso" required>
            <option value="JavaScript">JavaScript</option>
            <option value="Python">Python</option>
            <option value="Java">Java</option>
        </select>
        
        <label for="notaFinal">Nota Final:</label>
        <input type="number" id="notaFinal" required>
        
        <button type="submit">Cadastrar</button>
    </form>
    
    <h2>Lista de Alunos</h2>
    <table border="1">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Idade</th>
                <th>Curso</th>
                <th>Nota Final</th>
                <th>Situação</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody id="tabela-body"></tbody>
    </table>
    
    <h2>Relatórios</h2>
    <button onclick="listarAprovados()">Listar Aprovados</button>
    <button onclick="calcularMediaNotas()">Média das Notas</button>
    <button onclick="calcularMediaIdades()">Média das Idades</button>
    <button onclick="listarNomesOrdenados()">Nomes em Ordem Alfabética</button>
    <button onclick="quantidadeAlunosPorCurso()">Quantidade por Curso</button>
    
    <ul id="relatorio"></ul>
    
    <script>
        let alunos = [];

        document.getElementById("formulario").addEventListener("submit", (event) => {
            event.preventDefault();
            adicionarAluno();
        });

        const adicionarAluno = () => {
            const nome = document.getElementById('nome').value;
            const idade = document.getElementById('idade').value;
            const curso = document.getElementById('curso').value;
            const notaFinal = parseFloat(document.getElementById('notaFinal').value);

            if (nome && idade && curso && !isNaN(notaFinal)) {
                const situacao = notaFinal >= 7 ? "Aprovado" : "Reprovado";
                const aluno = { nome, idade, curso, notaFinal, situacao };
                alunos.push(aluno);
                atualizarTabela();
                limparFormulario();
                alert("Aluno cadastrado com sucesso!");
            }
        };

        const atualizarTabela = () => {
            const tbody = document.getElementById('tabela-body');
            tbody.innerHTML = '';

            alunos.forEach((aluno, index) => {
                let row = `<tr>
                    <td>${aluno.nome}</td>
                    <td>${aluno.idade}</td>
                    <td>${aluno.curso}</td>
                    <td>${aluno.notaFinal}</td>
                    <td>${aluno.situacao}</td>
                    <td>
                        <button class="editar" data-index="${index}">Editar</button>
                        <button class="excluir" data-index="${index}">Excluir</button>
                    </td>
                </tr>`;
                tbody.innerHTML += row;
            });
        };

        document.getElementById("tabela-body").addEventListener("click", (event) => {
            if (event.target.classList.contains("editar")) {
                editarAluno(event.target.dataset.index);
            } else if (event.target.classList.contains("excluir")) {
                excluirAluno(event.target.dataset.index);
            }
        });

        const excluirAluno = (index) => {
            alunos.splice(index, 1);
            atualizarTabela();
            alert("Aluno excluído com sucesso!");
        };

        const editarAluno = (index) => {
            const aluno = alunos[index];
            document.getElementById('nome').value = aluno.nome;
            document.getElementById('idade').value = aluno.idade;
            document.getElementById('curso').value = aluno.curso;
            document.getElementById('notaFinal').value = aluno.notaFinal;
            excluirAluno(index);
            alert("Aluno em edição, preencha os dados novamente e cadastre.");
        };

        const listarAprovados = () => {
            const aprovados = alunos.filter(aluno => aluno.notaFinal >= 7).map(aluno => aluno.nome);
            atualizarRelatorio("Aprovados: " + aprovados.join(", "));
        };

        const calcularMediaNotas = () => {
            const media = alunos.reduce((acc, aluno) => acc + aluno.notaFinal, 0) / alunos.length || 0;
            atualizarRelatorio("Média das Notas: " + media.toFixed(2));
        };

        const calcularMediaIdades = () => {
            const media = alunos.reduce((acc, aluno) => acc + parseInt(aluno.idade), 0) / alunos.length || 0;
            atualizarRelatorio("Média das Idades: " + media.toFixed(2));
        };

        const listarNomesOrdenados = () => {
            const nomesOrdenados = alunos.map(aluno => aluno.nome).sort();
            atualizarRelatorio("Nomes em Ordem Alfabética: " + nomesOrdenados.join(", "));
        };

        const quantidadeAlunosPorCurso = () => {
            const contagem = {};
            alunos.forEach(aluno => {
                contagem[aluno.curso] = (contagem[aluno.curso] || 0) + 1;
            });
            const resultado = Object.entries(contagem).map(([curso, qtd]) => `${curso}: ${qtd}`).join(", ");
            atualizarRelatorio("Quantidade por Curso: " + resultado);
        };

        const atualizarRelatorio = (texto) => {
            const relatorio = document.getElementById("relatorio");
            let item = document.createElement("li");
            item.textContent = texto;
            relatorio.appendChild(item);
        };
    </script>
</body>
</html>